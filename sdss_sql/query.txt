select n.time,aa.ra,aa.dec,aa.dered_r,aa.rowc,aa.colc,aa.rowcErr,aa.colcErr from 
 (select F.FieldID,distance*60 as dist,F.mjd_r - 5.36282183E4 as time, p.ra, p.dec, p.dered_r, rowc,colc,rowcErr,colcErr from 
  (select top 2 dbo.fSDSS(obj.objId) as ID, obj.objId,distance from
   (
      select objId1, objId2, -1/60. as distance FROM match
      union all
      select objId1, objId2, distance FROM match
   ) as M 
   join PhotoObj as Obj on (obj.objId = M.objId2)
   where M.objId1 = dbo.fGetNearestObjIdEq(342.19156468,-0.90203402,0.02)
  ) as r
  join PhotoObj  as p on r.objid = p.objid
  join Field as F on p.fieldID = F.fieldID
 ) as n
 join PhotoObj  as aa on aa.FieldID = n.FieldID

